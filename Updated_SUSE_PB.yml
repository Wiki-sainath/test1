---
- name: Detect and Execute RHEL 6 OS-specific tasks
  hosts: all
  gather_facts: yes
  vars:
    domain_name: "wikilab.asia"
    username: "sainath@wikilab.asia"
    password: "Redhat123"
    ansible_python_interpreter: /usr/bin/python2.7

  tasks:
  
    - name: Check if running on RHEL 6
      fail:
        msg: "This playbook only runs on RHEL 6 servers."
      when: ansible_distribution_major_version | int == 11 
      tags: always
      
    - name: Gather OS version and distribution facts
      debug:
        var: ansible_distribution_version
      register: os_version

    - name: Extract OS major version from facts
      set_fact:
        ansible_distribution_major_version: "{{ ansible_distribution_version.split('.')[0] }}"

    - name: Print the OS major version
      debug:
        var: ansible_distribution_major_version
